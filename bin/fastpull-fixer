#!/usr/bin/env python3

import os
from argparse import ArgumentParser

from subpop.hub import Hub

hub = Hub()

import dyne.org.funtoo.metatools.merge as merge


async def main_thread():
	for fp_entry in merge.model.FASTPULL.find({}):
		fp_path = merge.fastpull.get_disk_path(fp_entry["hashes"]["sha512"])
		if not os.path.exists(fp_path):
			print(fp_entry)
		if "sha512" in fp_entry:
			print("SHA512 IN WRONG PLACE!", fp_entry)


if __name__ == "__main__":

	merge.FIXUP_REPO = merge.tree.GitTree(
		"kit-fixups",
		merge.model.MERGE_CONFIG.branch("kit-fixups"),
		url=merge.model.MERGE_CONFIG.kit_fixups,
		root=merge.model.MERGE_CONFIG.source_trees + "/kit-fixups",
	)
	merge.FIXUP_REPO.initialize()

	hub.LOOP.run_until_complete(main_thread())

# vim: ts=4 sw=4 noet
